{"version":3,"file":"static/js/697.f6ca8582.chunk.js","mappings":"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","sources":["components/gestiones_asesores.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Swal from 'sweetalert2';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport 'datatables.net-bs5/css/dataTables.bootstrap5.min.css';\r\nimport $ from 'jquery';\r\nimport 'datatables.net-bs5';\r\n\r\nconst App = () => {\r\n  const [gestiones, setGestiones] = useState([]);\r\n  const [idUsuario, setIdUsuario] = useState(null);\r\n  const [idCampana, setIdCampana] = useState(null);\r\n\r\n  const getUrlParams = async () => {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const id = params.get('id');\r\n    const campana = params.get('campana');\r\n  \r\n    if (!id || !campana) {\r\n      Swal.fire({\r\n        icon: 'error',\r\n        title: 'Error',\r\n        text: 'Faltan parámetros en la URL.'\r\n      });\r\n      throw new Error('Faltan parámetros en la URL.');\r\n    }\r\n  \r\n    try {\r\n      const decryptedId = await decrypt(id);\r\n      const decryptedCampana = await decrypt(campana);\r\n      setIdUsuario(decryptedId);\r\n      setIdCampana(decryptedCampana);\r\n    } catch (error) {\r\n      console.error('Error al desencriptar parámetros:', error.message);\r\n    }\r\n  };\r\n  \r\n  const decrypt = async (value) => {\r\n    try {\r\n      const response = await axios.post('http://192.52.242.238:8000/api/decrypt', { encrypted_value: value });\r\n      return response.data.decrypted_value;\r\n    } catch (error) {\r\n      Swal.fire({\r\n        icon: 'error',\r\n        title: 'Error de Desencriptado',\r\n        text: 'No se pudo desencriptar el valor.'\r\n      });\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const encryptWithAPI = async (value) => {\r\n    if (!value || value.trim() === '') {\r\n      Swal.fire({\r\n        icon: 'error',\r\n        title: 'Error de Encriptado',\r\n        text: 'El valor a encriptar está vacío.'\r\n      });\r\n      throw new Error('El valor a encriptar está vacío.');\r\n    }\r\n    try {\r\n      const response = await axios.post('http://192.52.242.238:8000/api/encrypt', { value });\r\n      return response.data.encrypted_value;\r\n    } catch (error) {\r\n      Swal.fire({\r\n        icon: 'error',\r\n        title: 'Error de Encriptado',\r\n        text: 'No se pudo encriptar el valor.'\r\n      });\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const loadTable = async () => {\r\n    try {\r\n      const response = await axios.post('http://localhost:8000/api/gestiones', {\r\n        opcion: 7,\r\n        id_usuario: idUsuario,\r\n        id_campana: idCampana\r\n      });\r\n      console.log('Datos recibidos:', response.data); // Verifica si los datos están llegando\r\n      setGestiones(response.data);\r\n    } catch (error) {\r\n      Swal.fire({\r\n        icon: 'error',\r\n        title: 'Error',\r\n        text: 'No se pudo cargar la tabla de gestiones.'\r\n      });\r\n      console.error('Error al cargar datos:', error.message);\r\n    }\r\n  };\r\n  \r\n  const handleBackClick = async () => {\r\n    try {\r\n      const encryptedId = await encryptWithAPI(idUsuario);\r\n      const encryptedCampana = await encryptWithAPI(idCampana);\r\n      window.location.href = `modulos?id=${encryptedId}&campana=${encryptedCampana}`;\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  };\r\n\r\n  const handleGestionSubmit = async () => {\r\n    try {\r\n      const gestionValue = document.getElementById('gestionSelect').value;\r\n      await axios.post('http://192.52.242.238:8000/api/some-endpoint', {\r\n        id_usuario: idUsuario,\r\n        gestion: gestionValue\r\n      });\r\n      Swal.fire({\r\n        icon: 'success',\r\n        title: 'Éxito',\r\n        text: 'Gestión enviada correctamente.'\r\n      });\r\n    } catch (error) {\r\n      Swal.fire({\r\n        icon: 'error',\r\n        title: 'Error',\r\n        text: 'No se pudo enviar la gestión.'\r\n      });\r\n      console.error(error.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const initialize = async () => {\r\n      try {\r\n        await getUrlParams(); // Obtiene los parámetros y establece el estado\r\n      } catch (error) {\r\n        console.error('Error al obtener parámetros:', error.message);\r\n      }\r\n    };\r\n  \r\n    initialize();\r\n  }, []); // Solo se ejecuta al montar el componente\r\n  \r\n  useEffect(() => {\r\n    if (idUsuario && idCampana) {\r\n      loadTable(); // Solo carga los datos cuando los parámetros están listos\r\n    }\r\n  }, [idUsuario, idCampana]); // Se ejecuta cuando cambian los valores de idUsuario o idCampana\r\n  \r\n  useEffect(() => {\r\n    if (gestiones.length > 0) {\r\n      $('#gestionesTable').DataTable();\r\n    }\r\n  }, [gestiones]);\r\n\r\n  return (\r\n    <div className=\"container mt-5\">\r\n      <div className=\"card\">\r\n        <div className=\"card-header text-center\">\r\n          <h4>Gestiones</h4>\r\n        </div>\r\n        <div className=\"card-body\">\r\n          <table className=\"table table-striped\" id=\"gestionesTable\">\r\n            <thead>\r\n              <tr>\r\n                <th scope=\"col\">ID Gestión</th>\r\n                <th scope=\"col\">Nombre</th>\r\n                <th scope=\"col\">DPI</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {gestiones.map((gestion) => (\r\n                <tr key={gestion.ID_GESTIONES} onClick={async () => {\r\n                  const encryptedIdGestion = await encryptWithAPI(gestion.ID_GESTIONES);\r\n                  window.location.href = `detalle_gestion?id_gestion=${encryptedIdGestion}`;\r\n                }}>\r\n                  <td>{gestion.ID_GESTIONES}</td>\r\n                  <td>{gestion.NOMBRE}</td>\r\n                  <td>{gestion.DPI}</td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n          <button id=\"backButton\" className=\"btn btn-secondary mt-3\" onClick={handleBackClick}>\r\n            Regresar\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        className=\"modal fade\"\r\n        id=\"gestionModal\"\r\n        tabIndex=\"-1\"\r\n        aria-labelledby=\"gestionModalLabel\"\r\n        aria-hidden=\"true\"\r\n      >\r\n        <div className=\"modal-dialog\">\r\n          <div className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <h5 className=\"modal-title\" id=\"gestionModalLabel\">Seleccionar Gestión</h5>\r\n              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div className=\"modal-body\">\r\n              <div className=\"mb-3\">\r\n                <label htmlFor=\"gestionSelect\" className=\"form-label\">\r\n                  Seleccione una gestión:\r\n                </label>\r\n                <select id=\"gestionSelect\" className=\"form-select\">\r\n                  <option value=\"GESTIONANDO\">GESTIONANDO</option>\r\n                  <option value=\"REFACCIÓN\">REFACCIÓN</option>\r\n                  <option value=\"BAÑO\">BAÑO</option>\r\n                  <option value=\"REUNIÓN\">REUNIÓN</option>\r\n                  <option value=\"ALMUERZO\">ALMUERZO</option>\r\n                  <option value=\"ATENCIÓN AL CLIENTE\">ATENCIÓN AL CLIENTE</option>\r\n                  <option value=\"FIN DE JORNADA\">FIN DE JORNADA</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div className=\"modal-footer\">\r\n              <button type=\"button\" className=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\r\n                Cerrar\r\n              </button>\r\n              <button id=\"submitGestion\" type=\"button\" className=\"btn btn-primary\" onClick={handleGestionSubmit}>\r\n                Enviar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"names":["App","gestiones","setGestiones","useState","idUsuario","setIdUsuario","idCampana","setIdCampana","decrypt","async","axios","post","encrypted_value","value","data","decrypted_value","error","Swal","icon","title","text","encryptWithAPI","trim","Error","useEffect","params","URLSearchParams","window","location","search","id","get","campana","decryptedId","decryptedCampana","console","message","getUrlParams","initialize","response","opcion","id_usuario","id_campana","log","loadTable","length","$","DataTable","_jsxs","className","children","_jsx","scope","map","gestion","onClick","encryptedIdGestion","ID_GESTIONES","href","NOMBRE","DPI","encryptedId","encryptedCampana","tabIndex","type","htmlFor","gestionValue","document","getElementById"],"sourceRoot":""}