"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[697],{808:(e,a,t)=>{t.r(a),t.d(a,{default:()=>d});var r=t(43),s=t(213),o=t(64),n=t.n(o),i=(t(421),t(583),t(613)),c=t.n(i),l=(t(424),t(579));const d=()=>{const[e,a]=(0,r.useState)([]),[t,o]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),h=async e=>{try{return(await s.A.post("http://192.52.242.238:8000/api/decrypt",{encrypted_value:e})).data.decrypted_value}catch(a){throw n().fire({icon:"error",title:"Error de Desencriptado",text:"No se pudo desencriptar el valor."}),a}},m=async e=>{if(!e||""===e.trim())throw n().fire({icon:"error",title:"Error de Encriptado",text:"El valor a encriptar est\xe1 vac\xedo."}),new Error("El valor a encriptar est\xe1 vac\xedo.");try{return(await s.A.post("http://192.52.242.238:8000/api/encrypt",{value:e})).data.encrypted_value}catch(a){throw n().fire({icon:"error",title:"Error de Encriptado",text:"No se pudo encriptar el valor."}),a}};return(0,r.useEffect)((()=>{(async()=>{try{await(async()=>{const e=new URLSearchParams(window.location.search),a=e.get("id"),t=e.get("campana");if(!a||!t)throw n().fire({icon:"error",title:"Error",text:"Faltan par\xe1metros en la URL."}),new Error("Faltan par\xe1metros en la URL.");try{const e=await h(a),r=await h(t);o(e),d(r)}catch(r){console.error("Error al desencriptar par\xe1metros:",r.message)}})()}catch(e){console.error("Error al obtener par\xe1metros:",e.message)}})()}),[]),(0,r.useEffect)((()=>{t&&i&&(async()=>{try{const e=await s.A.post("http://localhost:8000/api/gestiones",{opcion:7,id_usuario:t,id_campana:i});console.log("Datos recibidos:",e.data),a(e.data)}catch(e){n().fire({icon:"error",title:"Error",text:"No se pudo cargar la tabla de gestiones."}),console.error("Error al cargar datos:",e.message)}})()}),[t,i]),(0,r.useEffect)((()=>{e.length>0&&c()("#gestionesTable").DataTable()}),[e]),(0,l.jsxs)("div",{className:"container mt-5",children:[(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("div",{className:"card-header text-center",children:(0,l.jsx)("h4",{children:"Gestiones"})}),(0,l.jsxs)("div",{className:"card-body",children:[(0,l.jsxs)("table",{className:"table table-striped",id:"gestionesTable",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",children:"ID Gesti\xf3n"}),(0,l.jsx)("th",{scope:"col",children:"Nombre"}),(0,l.jsx)("th",{scope:"col",children:"DPI"})]})}),(0,l.jsx)("tbody",{children:e.map((e=>(0,l.jsxs)("tr",{onClick:async()=>{const a=await m(e.ID_GESTIONES);window.location.href=`detalle_gestion?id_gestion=${a}`},children:[(0,l.jsx)("td",{children:e.ID_GESTIONES}),(0,l.jsx)("td",{children:e.NOMBRE}),(0,l.jsx)("td",{children:e.DPI})]},e.ID_GESTIONES)))})]}),(0,l.jsx)("button",{id:"backButton",className:"btn btn-secondary mt-3",onClick:async()=>{try{const e=await m(t),a=await m(i);window.location.href=`modulos?id=${e}&campana=${a}`}catch(e){console.error(e.message)}},children:"Regresar"})]})]}),(0,l.jsx)("div",{className:"modal fade",id:"gestionModal",tabIndex:"-1","aria-labelledby":"gestionModalLabel","aria-hidden":"true",children:(0,l.jsx)("div",{className:"modal-dialog",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h5",{className:"modal-title",id:"gestionModalLabel",children:"Seleccionar Gesti\xf3n"}),(0,l.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),(0,l.jsx)("div",{className:"modal-body",children:(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"gestionSelect",className:"form-label",children:"Seleccione una gesti\xf3n:"}),(0,l.jsxs)("select",{id:"gestionSelect",className:"form-select",children:[(0,l.jsx)("option",{value:"GESTIONANDO",children:"GESTIONANDO"}),(0,l.jsx)("option",{value:"REFACCI\xd3N",children:"REFACCI\xd3N"}),(0,l.jsx)("option",{value:"BA\xd1O",children:"BA\xd1O"}),(0,l.jsx)("option",{value:"REUNI\xd3N",children:"REUNI\xd3N"}),(0,l.jsx)("option",{value:"ALMUERZO",children:"ALMUERZO"}),(0,l.jsx)("option",{value:"ATENCI\xd3N AL CLIENTE",children:"ATENCI\xd3N AL CLIENTE"}),(0,l.jsx)("option",{value:"FIN DE JORNADA",children:"FIN DE JORNADA"})]})]})}),(0,l.jsxs)("div",{className:"modal-footer",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cerrar"}),(0,l.jsx)("button",{id:"submitGestion",type:"button",className:"btn btn-primary",onClick:async()=>{try{const e=document.getElementById("gestionSelect").value;await s.A.post("http://192.52.242.238:8000/api/some-endpoint",{id_usuario:t,gestion:e}),n().fire({icon:"success",title:"\xc9xito",text:"Gesti\xf3n enviada correctamente."})}catch(e){n().fire({icon:"error",title:"Error",text:"No se pudo enviar la gesti\xf3n."}),console.error(e.message)}},children:"Enviar"})]})]})})})]})}}}]);
//# sourceMappingURL=697.f6ca8582.chunk.js.map